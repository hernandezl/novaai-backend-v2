<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Home â€“ NeguNova</title>
<style>
  :root{
    --bg:#121212; --panel:#1e1e1e; --ink:#e9e9e9; --muted:#b8b8b8;
    --orange:#ff7a00; --orange2:#ff5100; --accent:#ffd000; --ring:#00ccff;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }

  /* Header */
  .main-header{
    background:linear-gradient(90deg,#ff7a00,#ff3b2f);
    padding:14px 20px; display:flex; align-items:center; gap:24px;
    position:sticky; top:0; z-index:50;
  }
  .logo{font-weight:800; letter-spacing:.3px; font-size:22px}
  .nav{display:flex; gap:14px; margin-left:auto}
  .nav a{
    color:#fff; text-decoration:none; font-weight:700; padding:8px 14px; border-radius:8px;
  }
  .nav a:hover{background:rgba(255,255,255,.2); color:black}

  /* Hero */
  .hero{
    position:relative; overflow:hidden; border-bottom:1px solid #2a2a2a;
  }
  .hero video,.hero img{width:100%; height:420px; object-fit:cover; display:block}
  .hero .overlay{
    position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
    background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.65));
    text-align:center; padding:24px;
  }
  .hero h1{margin:0; font-size:44px; letter-spacing:.4px}
  .hero p{margin:12px 0 0; color:var(--muted)}
  .hero .tools{position:absolute; right:18px; bottom:18px; display:flex; gap:8px}
  .chip{background:rgba(0,0,0,.45); border:1px solid #2f2f2f; padding:8px 12px; border-radius:999px}

  /* Grid */
  .wrap{max-width:1250px; margin:22px auto; padding:0 16px}
  .grid{
    display:grid; grid-template-columns:repeat(12,1fr); grid-auto-rows:28px; gap:16px;
  }
  .card{
    grid-column:span var(--w,4); grid-row:span var(--h,22);
    background:var(--panel); border-radius:18px; position:relative; overflow:hidden;
    border:1px solid #2b2b2b; box-shadow:0 8px 30px rgba(0,0,0,.35);
  }
  .card.dragging{opacity:.6; outline:2px dashed var(--ring)}
  .titlebar{
    position:absolute; left:0; top:0; right:0; height:46px; display:flex; align-items:center;
    gap:12px; padding:0 14px; background:linear-gradient(180deg,rgba(0,0,0,.35),transparent);
    user-select:none; cursor:move; z-index:2;
  }
  .titlebar .t{font-weight:800; letter-spacing:.4px; text-shadow:0 2px 12px rgba(0,0,0,.6)}
  .titlebar .edit-btn{
    margin-left:auto; display:none; padding:6px 10px; border-radius:8px; border:1px solid #2a2a2a;
    background:rgba(255,255,255,.08); color:#fff; cursor:pointer;
  }
  body.admin-on .titlebar .edit-btn{display:inline-flex}

  .thumb{position:absolute; inset:0; top:46px}
  .thumb img{width:100%; height:100%; object-fit:cover; display:block; filter:contrast(1.03)}

  /* Resizers (rayitas) */
  .resizer{position:absolute; width:18px; height:18px; background:repeating-linear-gradient(45deg,#777 0 3px,#444 3px 6px); opacity:.9; border-radius:4px}
  .resizer.br{right:8px; bottom:8px; cursor:nwse-resize}
  .resizer.bl{left:8px; bottom:8px; cursor:nesw-resize}

  /* Modal (card editor & banner) */
  .modal{position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:60}
  .modal.on{display:flex}
  .panel{width:min(780px,92vw); background:#191919; border:1px solid #2b2b2b; border-radius:18px; padding:18px}
  .panel h3{margin:0 0 12px}
  .row{display:grid; grid-template-columns:1fr 1fr; gap:12px; margin:10px 0}
  .row label{display:flex; flex-direction:column; gap:6px}
  input[type="text"], input[type="number"]{padding:10px 12px; border-radius:10px; border:1px solid #333; background:#121212; color:#fff}
  .bar{display:flex; gap:8px; justify-content:flex-end; margin-top:14px}
  .btn{border:1px solid #333; background:#232323; color:#fff; padding:10px 14px; border-radius:12px; cursor:pointer}
  .btn.warn{background:#2b2020; border-color:#4b3030}
  .btn.ok{background:linear-gradient(90deg,#ff7a00,#ff3b2f); border-color:#ff7a00}

  /* Admin bar */
  .adminbar{
    position:fixed; right:18px; top:86px; display:flex; gap:8px; z-index:55;
    background:rgba(0,0,0,.35); padding:10px; border-radius:14px; border:1px solid #2a2a2a; backdrop-filter:blur(6px)
  }
  .adminbar .pill{padding:10px 12px; border-radius:10px; border:1px solid #333; background:#1a1a1a; cursor:pointer}
  .badge{font-weight:800}

  /* Floating buttons â€“ tu estilo original */
  .floating-buttons{
    position:fixed; top:50%; right:20px; transform:translateY(-50%); display:flex; flex-direction:column; gap:20px; z-index:70;
  }
  .fbtn{width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center;
        background:linear-gradient(to bottom right,#666,#999); border:3px solid transparent; box-shadow:inset 0 0 5px #000;
        transition:.28s ease; animation:float 3s ease-in-out infinite}
  @keyframes float{0%{transform:translateY(-50%) translateX(0)}50%{transform:translateY(calc(-50% - 6px)) translateX(0)}100%{transform:translateY(-50%) translateX(0)}}
  .fbtn img{width:28px; height:28px; transition:.28s}
  .novaai-btn{border-color:#882c00}.novaai-btn img{content:url('img/robot-off.svg')}
  .novaai-btn:hover{border-color:#ffae00; box-shadow:0 0 12px #ffae00}.novaai-btn:hover img{content:url('img/robot-on.svg')}
  .whatsapp-btn{border-color:#0d3c16}.whatsapp-btn img{content:url('img/whatsapp-off.svg')}
  .whatsapp-btn:hover{border-color:#00ff7f; box-shadow:0 0 12px #00ff7f}.whatsapp-btn:hover img{content:url('img/whatsapp-on.svg')}
  .chat-btn{border-color:#082144}.chat-btn img{content:url('img/chat-off.svg')}
  .chat-btn:hover{border-color:#00ccff; box-shadow:0 0 12px #00ccff}.chat-btn:hover img{content:url('img/chat-on.svg')}
</style>
</head>
<body>

<header class="main-header">
  <div class="logo">NeguNova</div>
  <nav class="nav">
    <a href="home.html">Home</a>
    <a href="products.html">Products</a>
    <a href="3d.html">3D Printing</a>
    <a href="tshirts.html">Tshirts Printing</a>
    <a href="orders.html">Orders</a>
    
  </nav>
</header>

<section class="hero" id="banner">
  <video id="heroVideo" autoplay muted playsinline src="img/banner.mp4"></video>
  <img id="heroImage" alt="Banner" style="display:none" />
  <div class="overlay">
    <div>
      <h1>Creative Laser Studio</h1>
      <p>Personalized gifts, signage, accessories & dÃ©cor. Design it your way with NeguNova.</p>
    </div>
    <div class="tools">
      <span class="chip" id="editBannerBtn">Edit banner</span>
      <span class="chip" id="replayVideoBtn">Replay</span>
    </div>
  </div>
</section>

<div class="wrap">
  <div class="grid" id="grid"></div>
</div>

<!-- Admin bar -->
<div class="adminbar">
  <span class="pill">Admin: <span class="badge" id="adminBadge">OFF</span></span>
  <button class="pill" id="adminToggle">ðŸ”’ Admin</button>
  <button class="pill" id="addCardBtn">ï¼‹ Add Card</button>
  <button class="pill" id="resetBtn">â†º Reset</button>
</div>

<!-- Card editor -->
<div class="modal" id="cardModal" aria-hidden="true">
  <div class="panel">
    <h3>Edit card</h3>
    <div class="row">
      <label>Category title
        <input type="text" id="fTitle" placeholder="Title">
      </label>
      <label>Image URL
        <input type="text" id="fUrl" placeholder="https://...">
      </label>
    </div>
    <div class="row">
      <label>Or upload image
        <input type="file" id="fFile" accept="image/*">
      </label>
      <label>Size (WxH, grid units)
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px">
          <input type="number" id="fW" min="1" max="12" value="4">
          <input type="number" id="fH" min="6" max="120" value="22">
        </div>
      </label>
    </div>
    <div class="bar">
      <button class="btn" id="fCancel">Cancel</button>
      <button class="btn warn" id="fDelete">Delete</button>
      <button class="btn" id="fDuplicate">Duplicate</button>
      <button class="btn ok" id="fSave">Save</button>
    </div>
  </div>
</div>

<!-- Banner editor -->
<div class="modal" id="bannerModal" aria-hidden="true">
  <div class="panel">
    <h3>Edit banner image</h3>
    <div class="row">
      <label>Image URL
        <input type="text" id="bUrl" placeholder="https://...">
      </label>
      <label>Or upload image
        <input type="file" id="bFile" accept="image/*">
      </label>
    </div>
    <div class="bar">
      <button class="btn" id="bCancel">Cancel</button>
      <button class="btn ok" id="bSave">Save</button>
    </div>
  </div>
</div>

<!-- Floating buttons (tu estilo) -->
<div class="floating-buttons">
  <a href="novaai.html" class="fbtn novaai-btn"><img alt="AI"></a>
  <a href="https://wa.me/1234567890" target="_blank" class="fbtn whatsapp-btn"><img alt="WhatsApp"></a>
  <a href="contacts.html" class="fbtn chat-btn"><img alt="Chat"></a>
</div>

<script>
/* ===========================
   Home Script (drop-in)
   - Normalizes links to absolute paths: /products.html, /novaai.html, /orders.html
   - Clears previous NovaAI selection before opening NovaAI
   - Keeps visual structure untouched
   =========================== */

(function(){
  "use strict";

  // ---- small helper: run when DOM is ready
  const onReady = (f) => (document.readyState !== 'loading')
    ? f()
    : document.addEventListener('DOMContentLoaded', f);

  onReady(() => {
    // Normalize known internal pages to absolute hrefs (robust with WordPress subfolders)
    const PAGES = new Set(['home.html','products.html','novaai.html','orders.html','contacts.html','tshirts.html','3d.html']);
    document.querySelectorAll('a[href]').forEach(a => {
      try {
        const href = a.getAttribute('href') || '';
        // Ignore external links, anchors, mailto, tel
        if (/^(https?:)?\/\//i.test(href) || href.startsWith('#') || href.startsWith('mailto:') || href.startsWith('tel:')) return;

        // If it looks like "page.html" and is one of our known pages, make it absolute
        const file = href.split('?')[0].split('#')[0];
        if (PAGES.has(file)) {
          const abs = '/' + file; // e.g. "/novaai.html"
          a.setAttribute('href', abs);
        }
      } catch(_) {}
    });

    // Hook the floating NovaAI button (and any other NovaAI link) to clear previous payload
    const isNovaLink = (el) => {
      const href = (el.getAttribute('href') || '').toLowerCase();
      return href.endsWith('/novaai.html') || href === '/novaai.html';
    };

    const clearNovaPayload = () => {
      try {
        sessionStorage.removeItem('novaai_incoming');         // product payload used by NovaAI
        sessionStorage.removeItem('novaai:selectedProduct');   // any legacy key used by products page
      } catch(_) {}
    };

    // 1) Floating button (common class names)
    const floatingCandidates = Array.from(document.querySelectorAll(
      '.floating-buttons a, .fab a, .novaai-fab, a.novaai, a[href="/novaai.html"], a[href$="/novaai.html"]'
    ));

    floatingCandidates.forEach(a => {
      if (isNovaLink(a)) {
        a.addEventListener('click', clearNovaPayload, { passive: true });
      }
    });

    // 2) Any navigation/menu links that target NovaAI
    document.querySelectorAll('a[href]').forEach(a => {
      if (isNovaLink(a)) {
        a.addEventListener('click', clearNovaPayload, { passive: true });
      }
    });

    // Optional: defensiveâ€”if someone opens NovaAI in a new tab via middle-click, still clear before navigating
    document.body.addEventListener('auxclick', (e) => {
      const a = e.target.closest && e.target.closest('a[href]');
      if (!a) return;
      if (isNovaLink(a)) clearNovaPayload();
    }, { passive: true });

    // Done
    // console.log('[Home] Links normalized and NovaAI payload clear hook ready.');
  });
})();
</script>

</body>
</html>
